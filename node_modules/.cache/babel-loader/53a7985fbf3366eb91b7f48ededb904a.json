{"ast":null,"code":"var _jsxFileName = \"/Users/NisaKhahidir/Ironhack/projectpets/FurryFriendFinder/FFF/client/src/pages/Profile.jsx\";\nimport React, { Component } from \"react\";\nimport { NavLink } from \"react-router-dom\";\nimport UserContext from \"../components/Auth/UserContext\";\nimport apiHandler from \"../api/apiHandler\";\nimport FormEditAnnounce from \"../components/Forms/FormEditAnnounce\";\nimport { Link } from \"react-router-dom\";\nimport FormAnnouncement from \"../components/Forms/FormAnnouncement\";\nimport CardAnnounce from \"../components/CardAnnounce\";\nimport FeedBack from \"../components/Feedback\";\nimport Button from \"../Button\";\n\nclass Profile extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      phoneNumber: \"\",\n      httpResponse: null,\n      userAnnounces: [],\n      selectedAnnounce: null\n    };\n\n    this.submitPhoneNumber = event => {\n      event.preventDefault(); // Disable the forms default behaviour (refresh the page and make request.)\n\n      const {\n        httpResponse,\n        userAnnounces,\n        selectedAnnounce,\n        ...userData\n      } = this.state;\n      apiHandler.updateUser(userData).then(data => {\n        this.context.setUser(data);\n        this.setState({\n          httpResponse: {\n            status: \"success\",\n            message: \"Phone number added.\"\n          }\n        });\n        this.timeoutId = setTimeout(() => {\n          this.setState({\n            httpResponse: null\n          });\n        }, 1000);\n      }).catch(error => {\n        this.setState({\n          httpResponse: {\n            status: \"failure\",\n            message: \"An error occured, try again later\"\n          }\n        });\n        this.timeoutId = setTimeout(() => {\n          this.setState({\n            httpResponse: null\n          });\n        }, 1000);\n      });\n    };\n\n    this.handlePhoneNumber = event => {\n      this.setState({\n        phoneNumber: event.target.value\n      });\n    };\n\n    this.deleteAnnounce = announceId => {\n      apiHandler.removeAnnounce(announceId).then(() => {\n        const userAnnounces = [...this.state.userAnnounces].filter(announce => announce._id !== announceId);\n        this.setState({\n          userAnnounces\n        });\n      });\n    };\n\n    this.onAnnounceSelect = announceId => {\n      const selectedAnnounce = this.state.userAnnounces.find(announce => announce._id === announceId);\n      this.setState({\n        selectedAnnounce: selectedAnnounce\n      });\n    };\n\n    this.onEditFormClose = () => {\n      this.setState({\n        selectedAnnounce: null\n      });\n    };\n\n    this.handleAnnounceUpdate = updatedAnnounce => {\n      const userAnnounces = [...this.state.userAnnounces].map(announce => announce._id === updatedAnnounce._id ? updatedAnnounce : announce);\n      this.setState({\n        userAnnounces\n      });\n    };\n\n    this.addAnnounce = announce => {\n      this.setState({\n        userAnnounces: [...this.state.userAnnounces, announce]\n      });\n    };\n  }\n\n  componentDidMount() {\n    apiHandler.getUserAnnounce().then(data => {\n      this.setState({\n        userAnnounces: data\n      });\n    });\n  }\n\n  render() {\n    const {\n      user\n    } = this.context;\n    const {\n      userAnnounces,\n      selectedAnnounce,\n      httpResponse\n    } = this.state;\n    if (!user) return null;\n    return /*#__PURE__*/React.createElement(\"section\", {\n      className: \"Profile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 7\n      }\n    }, selectedAnnounce && /*#__PURE__*/React.createElement(FormEditAnnounce, {\n      item: selectedAnnounce,\n      handleClose: this.onEditFormClose,\n      onItemUpdate: this.handleAnnounceUpdate,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }\n    }), user && this.props.displayForm && /*#__PURE__*/React.createElement(FormAnnouncement, {\n      handleClose: this.props.handleFormClose,\n      addAnnounce: this.addAnnounce,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"user-presentation\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }\n    }, user.username), /*#__PURE__*/React.createElement(\"button\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(NavLink, {\n      to: \"/create\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 19\n      }\n    }, \"Report Missing\")), /*#__PURE__*/React.createElement(\"button\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      className: \"link\",\n      to: \"/profile/settings\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 19\n      }\n    }, \"Edit profile\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"user-contact\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 11\n      }\n    }, \"Add a phone number\"), httpResponse && /*#__PURE__*/React.createElement(FeedBack, {\n      message: httpResponse.message,\n      status: httpResponse.status,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"form\", {\n      className: \"form\",\n      onChange: this.handlePhoneNumber,\n      onSubmit: this.submitPhoneNumber,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"label\",\n      htmlFor: \"phoneNumber\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 15\n      }\n    }, \"Phone number\"), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"input\",\n      id: \"phoneNumber\",\n      type: \"text\",\n      name: \"phoneNumber\",\n      defaultValue: this.context.user.phoneNumber || \"\",\n      placeholder: \"Add phone number\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(Button, {\n      primary: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 13\n      }\n    }, \"Add phone number\"))), !userAnnounces.length && /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"{}\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 13\n      }\n    }, \"You don't have any  :(\")), !!userAnnounces.length && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"CardAnnounce\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 13\n      }\n    }, \"Your announcements\"), this.state.userAnnounces && this.state.userAnnounces.map(announce => {\n      if (announce.missing) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"missing_info\",\n          key: announce._id,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"img\", {\n          style: {\n            width: \"100vw\",\n            height: \"\"\n          },\n          src: announce.image,\n          alt: announce.name,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 29\n          }\n        }), /*#__PURE__*/React.createElement(Link, {\n          to: `/missing/${announce._id}`,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"h2\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 27\n          }\n        }, announce.title)), /*#__PURE__*/React.createElement(\"h3\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }\n        }, announce.name), /*#__PURE__*/React.createElement(\"h3\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 25\n          }\n        }, announce.location), /*#__PURE__*/React.createElement(\"h3\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 25\n          }\n        }, announce.pet_type), /*#__PURE__*/React.createElement(\"h3\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 25\n          }\n        }, announce.description));\n      }\n    })));\n  }\n\n}\n\nProfile.contextType = UserContext;\nexport default Profile;","map":{"version":3,"sources":["/Users/NisaKhahidir/Ironhack/projectpets/FurryFriendFinder/FFF/client/src/pages/Profile.jsx"],"names":["React","Component","NavLink","UserContext","apiHandler","FormEditAnnounce","Link","FormAnnouncement","CardAnnounce","FeedBack","Button","Profile","state","phoneNumber","httpResponse","userAnnounces","selectedAnnounce","submitPhoneNumber","event","preventDefault","userData","updateUser","then","data","context","setUser","setState","status","message","timeoutId","setTimeout","catch","error","handlePhoneNumber","target","value","deleteAnnounce","announceId","removeAnnounce","filter","announce","_id","onAnnounceSelect","find","onEditFormClose","handleAnnounceUpdate","updatedAnnounce","map","addAnnounce","componentDidMount","getUserAnnounce","render","user","props","displayForm","handleFormClose","username","length","missing","width","height","image","name","title","location","pet_type","description","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { NavLink } from \"react-router-dom\";\nimport UserContext from \"../components/Auth/UserContext\";\nimport apiHandler from \"../api/apiHandler\";\nimport FormEditAnnounce from \"../components/Forms/FormEditAnnounce\";\nimport { Link } from \"react-router-dom\";\nimport FormAnnouncement from \"../components/Forms/FormAnnouncement\";\nimport CardAnnounce from \"../components/CardAnnounce\";\nimport FeedBack from \"../components/Feedback\";\nimport Button from \"../Button\"\n\nclass Profile extends Component {\n  static contextType = UserContext;\n  \n  state = {\n    phoneNumber: \"\",\n    httpResponse: null,\n    userAnnounces:[],\n    selectedAnnounce: null,\n  };\n\n  componentDidMount() {\n    apiHandler\n    .getUserAnnounce()\n    .then((data) => {\n      this.setState({ userAnnounces: data });\n    });\n  }\n\n  submitPhoneNumber = (event) => {\n    event.preventDefault(); // Disable the forms default behaviour (refresh the page and make request.)\n    const { httpResponse, userAnnounces, selectedAnnounce, ...userData } = this.state;\n    apiHandler\n      .updateUser(userData)\n      .then((data) => {\n        this.context.setUser(data);\n        this.setState({\n          httpResponse: { status: \"success\", message: \"Phone number added.\" },\n        });\n        this.timeoutId = setTimeout(() => {\n          this.setState({ httpResponse: null });\n        }, 1000);\n      })\n      .catch((error) => {\n        this.setState({\n          httpResponse: {\n            status: \"failure\",\n            message: \"An error occured, try again later\",\n          },\n        });\n        this.timeoutId = setTimeout(() => {\n          this.setState({ httpResponse: null });\n        }, 1000);\n      });\n  };\n\n  handlePhoneNumber = (event) => {\n    this.setState({ phoneNumber: event.target.value });\n  };\n\n\n\n  deleteAnnounce = (announceId) => {\n    apiHandler.removeAnnounce(announceId).then(() => {\n      const userAnnounces = [...this.state.userAnnounces].filter(\n        (announce) =>  announce._id !== announceId\n      );\n      this.setState({ userAnnounces });\n    });\n  };\n\n  onAnnounceSelect = (announceId) => {\n    const selectedAnnounce = this.state.userAnnounces.find(\n      (announce) => announce._id === announceId\n    );\n    this.setState({ selectedAnnounce: selectedAnnounce });\n  };\n\n  onEditFormClose = () => {\n    this.setState({ selectedAnnounce: null });\n  };\n\n  handleAnnounceUpdate = (updatedAnnounce) => {\n    const userAnnounces = [...this.state.userAnnounces].map((announce) =>\n    announce._id === updatedAnnounce._id ? updatedAnnounce : announce\n    );\n    this.setState({ userAnnounces });\n  };\n  \n  addAnnounce = (announce) => {\n    this.setState({ userAnnounces: [...this.state.userAnnounces, announce] });\n  };\n\n  render() {\n    const { user } = this.context;\n    const { userAnnounces, selectedAnnounce, httpResponse } = this.state;\n    if (!user) return null;\n    \n    return (\n      <section className=\"Profile\">\n         \n        {selectedAnnounce && (\n          <FormEditAnnounce\n            item={selectedAnnounce}\n            handleClose={this.onEditFormClose}\n            onItemUpdate={this.handleAnnounceUpdate}\n          />\n        )}\n        {user && this.props.displayForm && (\n          <FormAnnouncement\n            handleClose={this.props.handleFormClose}\n            addAnnounce={this.addAnnounce}\n          />\n        )}\n        <div className=\"user-presentation\">\n          <h2 className=\"title\">\n            {user.username}\n          </h2>\n          <button><NavLink to=\"/create\">Report Missing</NavLink></button>\n\n          <button><Link className=\"link\" to=\"/profile/settings\">Edit profile</Link></button>\n        </div>\n\n        <div className=\"user-contact\">\n          <h4>Add a phone number</h4>\n          {httpResponse && (\n            <FeedBack\n              message={httpResponse.message}\n              status={httpResponse.status}\n            />\n          )}\n          <form\n            className=\"form\"\n            onChange={this.handlePhoneNumber}\n            onSubmit={this.submitPhoneNumber}\n          >\n            <div className=\"form-group\">\n              <label className=\"label\" htmlFor=\"phoneNumber\">\n                Phone number\n              </label>\n              <input\n                className=\"input\"\n                id=\"phoneNumber\"\n                type=\"text\"\n                name=\"phoneNumber\"\n                defaultValue={this.context.user.phoneNumber || \"\"}\n                placeholder=\"Add phone number\"\n              />\n            </div>\n            <Button primary>Add phone number</Button>\n          </form>\n        </div>\n\n        {!userAnnounces.length && (\n          <React.Fragment>\n            <div className=\"\">\n              <img src=\"{}\" alt=\"\" />\n            </div>\n            <p>You don't have any  :(</p>\n          </React.Fragment>\n        )}\n\n        {!!userAnnounces.length && (\n          <div className=\"CardAnnounce\">\n            <h3>Your announcements</h3>\n            {this.state.userAnnounces  && this.state.userAnnounces.map((announce) => {\n                if (announce.missing){\n                    return (\n                        <div className=\"missing_info\" key={announce._id}>\n                            <img\n                          style={{\n                            width: \"100vw\",\n                            height: \"\",\n                          }}\n                          src={announce.image}\n                          alt={announce.name}\n                            />\n                        <Link to={`/missing/${announce._id}`}>\n                          <h2>{announce.title}</h2>\n                        </Link>\n                        <h3>{announce.name}</h3>\n                        <h3>{announce.location}</h3>\n                        <h3>{announce.pet_type}</h3>\n                        <h3>{announce.description}</h3>\n        \n                      </div>\n                    )}\n               \n            \n            })}\n          </div>\n        )}\n      </section>\n    );\n  \n     \n      \n  }\n}\n\n\n\nexport default Profile;\n\n"]},"metadata":{},"sourceType":"module"}